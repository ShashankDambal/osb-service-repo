name: Deploy OSB Service

on:
  workflow_dispatch:  # Manual trigger

jobs:
  deploy:
    runs-on: self-hosted  # Runs on your Windows runner

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      - name: Configure Maven Authentication
        run: |
          echo "<settings>
            <servers>
              <server>
                <id>github</id>
                <username>ShashankDambal</username>
                <password>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</password>
              </server>
            </servers>
          </settings>" > $HOME/.m2/settings.xml

      - name: Download OSB JAR from GitHub Packages
        shell: cmd
        run: mvn dependency:get -Dartifact=com.example:osb-service:1.0.0 -DremoteRepositories="github::default::https://maven.pkg.github.com/ShashankDambal/osb-service-repo" -Ddest=C:\Oracle\Middleware\deployments\osb\
            
      - name: Deploy OSB Using WLST
        run: C:\Oracle\Middleware\OMW_Home\oracle_common\common\bin\wlst.cmd C:\Oracle\Middleware\deployments\osb\deploy_osb.py
